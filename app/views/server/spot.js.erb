(function(){
  var ad_data = '<%= format_for_javascript(partial("shared/ad", :campaign => @campaign, :format => :html)) %>';
  var ad_spot = document.getElementById('greed_<%= @spot.id %>');
  var tmp_container = document.createElement('div');
  tmp_container.innerHTML = ad_data;
  ad_spot.appendChild(tmp_container);
  
  var links = ad_spot.getElementsByTagName('a');
  
  for(var i=0; i<links.length; i++){
    links[i].onclick = function(){
      var url = this.getAttribute('href');
      var img = new Image();
      img.src = "<%= host_with_port %>/server/click/<%= @campaign.id %>";
      return true;
    }
  }
})();